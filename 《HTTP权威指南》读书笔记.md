# 《HTTP权威指南》读书笔记

## 第一部分 HTTP： Web 的基础
### 第 1 章 HTTP 概述
**MIME类型：**（Multipurpose Internet Mail Extension， 多用途因特网邮件扩展、数据格式标签）MIME 类型是一种文本标记， 表示一种主要的对象类型和一个特定的子类型， 中间由一条斜杠来分隔。*如：Content-type: image/jpeg*

**URI：** 服务器资源名被称为统一资源标识符（Uniform Resource Identifier），URI 有两种形式， 分别称为 URL 和 URN。

**URL：** 统一资源定位符（URL）

**URN：** URI 的第二种形式就是统一资源名（URN）。 URN 是作为特定内容的唯一名称使用的， 与目前的资源所在地无关。 

**HTTP 报文**是由一行一行的简单字符串组成的。 HTTP 报文都是纯文本， 不是二进
  制代码， 所以人们可以很方便地对其进行读写。
   
  ![C8sRmT.png](https://s1.ax1x.com/2018/04/28/C8sRmT.png)

**TCP/IP**
用网络术语来说， HTTP 协议位于 TCP 的上层。 HTTP 使用 TCP 来传输其报文数据。 与之类似， TCP 则位于 IP 的上层。

![C86UIg.png](https://s1.ax1x.com/2018/04/28/C86UIg.png)

**IP** 网际协议（Internet Protocol， IP）

- Web的结构组件
    - **代理**  
        代理位于客户端和服务器之间， 接收所有客户端的 HTTP 请求， 并将这些请求转发给服务器（可能会对请求进行修改之后转发）。 
    - **缓存**  
        Web 缓存（Web cache） 或代理缓存（proxy cache） 是一种特殊的 HTTP 代理服务器， 可以将经过代理传送的常用文档复制保存起来。 下一个请求同一文档的客户端就可以享受缓存的私有副本所提供的服务了
    - **网关**  
        网关（gateway） 是一种特殊的服务器， 作为其他服务器的中间实体使用。 通常用于将 HTTP 流量转换成其他的协议。
    - **隧道**  
        隧道（tunnel） 是建立起来之后， 就会在两条连接之间对原始数据进行盲转发的HTTP 应用程序。 HTTP 隧道通常用来在一条或多条 HTTP 连接上转发非 HTTP 数据， 转发时不会窥探数据。
    - **Agent代理**
        用户 Agent 代理（或者简称为 Agent 代理） 是代表用户发起 HTTP 请求的客户端程序。
        
### 第 2 章 URL与资源
大多数 URL 方案的 URL 语法都建立在这个由 9 部分构成的通用格式上：
```
<scheme>://<user>:<password>@<host>:<port>/<path>;<params>?<query>#<frag>
```

### 第 3 章 HTTP报文
#### HTTP报文分类
1. **请求报文（request message）**  
    请求报文的格式
    ```
    <method> <request-URL> <version>         # 请求行/起始行
    <headers>
    
    <entity-body>
    ```
    
    - **方法（method）**  
    客户端希望服务器对资源执行的动作。 是一个单独的词， 比如 GET、 HEAD 或POST。 本章稍后将详细介绍方法。
    - **请求URL（request-URL）**  
    命名了所请求资源， 或者 URL 路径组件的完整 URL。 如果直接与服务器进行对话， 只要 URL 的路径组件是资源的绝对路径， 通常就不会有什么问题——服务器可以假定自己是 URL 的主机 / 端口。
    - **版本（version）**  
    报文所使用的 HTTP 版本， 其格式看起来是这样的：
    ```
    HTTP/<major>.<minor>
    ```
    其中主要版本号（major） 和次要版本号（minor） 都是整数。 
    - **首部（header）**  
    可以有零个或多个首部， 每个首部都包含一个名字， 后面跟着一个冒号（:）， 然后是一个可选的空格， 接着是一个值， 最后是一个 CRLF。 首部是由一个空行（CRLF） 结束的， 表示了首部列表的结束和实体主体部分的开始。 有些 HTTP 版本， 比如 HTTP/1.1， 要求有效的请求或响应报文中必须包含特定的首部。 
    - **实体的主体部分（entity-body）**  
    实体的主体部分包含一个由任意数据组成的数据块。 并不是所有的报文都包含实体的主体部分， 有时， 报文只是以一个 CRLF 结束。 

1. **响应报文（response message）**  
    响应报文的格式
    
    ```
    <version> <status> <reason-phrase>         # 响应行/起始行
    <headers>
    
    <entity-body>
    ```
    
    - **状态码（status-code）**  
    这三位数字描述了请求过程中所发生的情况。 每个状态码的第一位数字都用于描述状态的一般类别（“成功”、“出错” 等）。
    - **原因短语（reason-phrase）**  
    数字状态码的可读版本， 包含行终止序列之前的所有文本。  原因短语只对人类有意义， 因此， 比如说， 尽管响应行 HTTP/1.0 200 NOT OK 和 HTTP/1.0 200 OK 中原因短语的含义不同， 但同样都会被当作成功指示处理。

#### 常用的HTTP方法
| 方法 | 描述 | 是否包含主体 |
|----|----|----|
| GET | 从服务器获取一份文档 | 否 |
| HEAD | 只从服务器获取文档的首部 | 否 |
| POST | 向服务器发送需要处理的数据 | 是 |
| PUT | 将请求的主体部分存储在服务器上 | 是 |
| TRACE | 对可能经过代理服务器传送到服务器上去的报文进行追踪 | 否 |
| OPTIONS | 决定可以在服务器上执行哪些方法 | 否 |
| DELETE | 从服务器上删除一份文档 | 否 |

#### 状态码
方法是用来告诉服务器做什么事情的， 状态码则用来告诉客户端， 发生了什么事情。

**状态码分类**

| 整体范围 | 已定义范围 | 分类 |
|:----:|:----:|:----:|
| 100 ～ 199 | 100 ～ 101 | 信息提示 |
| 200 ～ 299 | 200 ～ 206 | 成功 |
| 300 ～ 399 | 300 ～ 305 | 重定向 |
| 400 ～ 499 | 400 ～ 415 | 客户端错误 |
| 500 ～ 599 | 500 ～ 505 | 服务器错误 |

**1. 100～199——信息性状态码**  
    **信息性状态码及原因短语**
    
| 状态码 | 原因短语 | 含义 |
|:----:|----|----|
| 100 | Continue | 说明收到了请求的初始部分， 请客户端继续。 发送了这个状态码之后， 服务器在收到请求之后必须进行响应。 |
| 101 | Switching Protocols | 说明服务器正在根据客户端的指定， 将协议切换成 Update 首部所列的协议 |

**2. 200～299——成功状态**  
    **成功状态码和原因短语**
    
| 状态码 | 原因短语 | 含义 |
|:----:|----|----|
| 200 | OK | 请求没问题， 实体的主体部分包含了所请求的资源 |
| 201 | Created | 用于创建服务器对象的请求（比如， PUT）。 响应的实体主体部分中应该包含各种引用了已创建的资源的 URL， Location 首部包含的则是最具体的引用。服务器必须在发送这个状态码之前创建好对象 |
| 202 | Accepted | 请求已被接受， 但服务器还未对其执行任何动作。 不能保证服务器会完成这个请求； 这只是意味着接受请求时， 它看起来是有效的。服务器应该在实体的主体部分包含对请求状态的描述， 或许还应该有对请求完成时间的估计（或者包含一个指针， 指向可以获取此信息的位置） |
| 203 | Non-Authoritative Information | 实体首部包含的信息不是来自于源端服务器， 而是来自资源的一份副本。 如果中间节点上有一份资源副本， 但无法或者没有对它所发送的与资源有关的元信息（首部） 进行验证， 就会出现这种情况。这种响应码并不是非用不可的； 如果实体首部来自源端服务器， 响应为 200 状态的应用程序就可以将其作为一种可选项使用 |
| 204 | No Content | 响应报文中包含若干首部和一个状态行， 但没有实体的主体部分。 主要用于在浏览器不转为显示新文档的情况下， 对其进行更新（比如刷新一个表单页面） |
| 205 | Reset Content | 另一个主要用于浏览器的代码。 负责告知浏览器清除当前页面中的所有 HTML 表单元素 |
| 206 | Partial Content | 成功执行了一个部分或 Range（范围） 请求。 稍后我们会看到， 客户端可以通过一些特殊的首部来获取部分或某个范围内的文档——这个状态码就说明范围请求成功了。206响应中必须包含 Content-Range、 Date 以及 ETag 或 ContentLocation 首部 |

#### 首部
**1. 首部分类**
    - **通用首部：**
    既可以出现在请求报文中， 也可以出现在响应报文中。
    - **请求首部：**
    提供更多有关请求的信息。
    - **响应首部：**
    提供更多有关响应的信息。
    - **实体首部：**
    描述主体的长度和内容， 或者资源自身。
    - **扩展首部：**
    规范中没有定义的新首部。
    
**2. 首部延续行**  
    将长的首部行分为多行可以提高可读性， 多出来的每行前面至少要有一个空格或制表符（tab）。
    
#### 方法
1.  安全方法  
    HTTP 定义了一组被称为安全方法的方法。 GET 方法和 HEAD 方法都被认为是安全
的， 这就意味着使用 GET 或 HEAD 方法的 HTTP 请求都不会产生什么动作。

## 第二部分 HTTP 结构
## 第三部分 识别、 认证与安全
## 第四部分 实体、 编码和国际化
## 第五部分 内容发布与分发
## 第六部分 附录
